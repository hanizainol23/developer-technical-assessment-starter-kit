{"ast":null,"code":"import axios from 'axios';\nconst API_BASE = process.env.REACT_APP_API_URL || 'http://localhost:3000';\nexport const api = axios.create({\n  baseURL: API_BASE,\n  headers: {\n    'Content-Type': 'application/json'\n  },\n  withCredentials: true // Enable cookies in requests\n});\n\n// Custom error interface\n\n// Request interceptor - add auth token if stored\napi.interceptors.request.use(config => {\n  // Token is automatically sent via HTTP-only cookie\n  // But we can also check localStorage for optional Bearer token backup\n  const token = localStorage.getItem('backup_jwt_token');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n}, error => {\n  return Promise.reject(error);\n});\n\n// Response interceptor - handle errors globally\napi.interceptors.response.use(response => response, error => {\n  // Handle network errors\n  if (!error.response) {\n    const networkError = new Error('Network error. Please check your connection.');\n    networkError.statusCode = 0;\n    return Promise.reject(networkError);\n  }\n  const {\n    status,\n    data\n  } = error.response;\n\n  // Handle 401 - Token expired or invalid\n  if (status === 401) {\n    localStorage.removeItem('backup_jwt_token');\n    if (window.location.pathname !== '/login') {\n      window.location.href = '/login?session_expired=true';\n    }\n    const authError = new Error('Session expired. Please log in again.');\n    authError.statusCode = 401;\n    return Promise.reject(authError);\n  }\n\n  // Handle 403 - Forbidden\n  if (status === 403) {\n    const forbiddenError = new Error('You do not have permission to access this resource.');\n    forbiddenError.statusCode = 403;\n    return Promise.reject(forbiddenError);\n  }\n\n  // Handle 404 - Not found\n  if (status === 404) {\n    const notFoundError = new Error('Resource not found.');\n    notFoundError.statusCode = 404;\n    return Promise.reject(notFoundError);\n  }\n\n  // Handle 429 - Too many requests\n  if (status === 429) {\n    const rateLimitError = new Error('Too many requests. Please try again later.');\n    rateLimitError.statusCode = 429;\n    return Promise.reject(rateLimitError);\n  }\n\n  // Handle 500+ - Server errors\n  if (status >= 500) {\n    const serverError = new Error('Server error. Please try again later.');\n    serverError.statusCode = status;\n    return Promise.reject(serverError);\n  }\n\n  // Handle validation errors (400, 422)\n  if (status === 400 || status === 422) {\n    const validationError = new Error(Array.isArray(data.message) ? data.message.join(', ') : data.message || 'Invalid request');\n    validationError.statusCode = status;\n    return Promise.reject(validationError);\n  }\n\n  // Generic error handling\n  const message = Array.isArray(data.message) ? data.message.join(', ') : data.message || `Error: ${status}`;\n  const genericError = new Error(message);\n  genericError.statusCode = status;\n  return Promise.reject(genericError);\n});\n\n// Auth API\nexport const authApi = {\n  register: (email, password, name) => api.post('/auth/register', {\n    email,\n    password,\n    name\n  }),\n  login: (email, password) => api.post('/auth/login', {\n    email,\n    password\n  }),\n  logout: () => api.post('/auth/logout')\n};\n\n// Listings API\nexport const listingsApi = {\n  popular: (limit = 6) => api.get(`/listings/popular?limit=${limit}`),\n  search: (query = '', location = '', limit = 20) => {\n    const params = new URLSearchParams();\n    if (query) params.append('q', query);\n    if (location) params.append('location', location);\n    params.append('limit', String(limit));\n    return api.get(`/listings/search?${params.toString()}`);\n  }\n};\n\n// Properties API\nexport const propertiesApi = {\n  getOne: id => api.get(`/property/${id}`)\n};\n\n// Projects API\nexport const projectsApi = {\n  getOne: id => api.get(`/project/${id}`)\n};\n\n// Lands API\nexport const landsApi = {\n  getOne: id => api.get(`/land/${id}`)\n};\n\n// Agent Contacts API\nexport const agentContactApi = {\n  create: payload => api.post('/agent-contact', payload)\n};\n\n// Utility function to check if user is authenticated\nexport const isAuthenticated = () => {\n  return true; // Let backend validation via interceptors handle it\n};\n\n// Utility function to get error message from API error\nexport const getErrorMessage = error => {\n  var _error$response, _error$response$data;\n  if (error !== null && error !== void 0 && error.message) {\n    return error.message;\n  }\n  if (error !== null && error !== void 0 && (_error$response = error.response) !== null && _error$response !== void 0 && (_error$response$data = _error$response.data) !== null && _error$response$data !== void 0 && _error$response$data.message) {\n    const msg = error.response.data.message;\n    return Array.isArray(msg) ? msg.join(', ') : msg;\n  }\n  return 'An unexpected error occurred. Please try again.';\n};","map":{"version":3,"names":["axios","API_BASE","process","env","REACT_APP_API_URL","api","create","baseURL","headers","withCredentials","interceptors","request","use","config","token","localStorage","getItem","Authorization","error","Promise","reject","response","networkError","Error","statusCode","status","data","removeItem","window","location","pathname","href","authError","forbiddenError","notFoundError","rateLimitError","serverError","validationError","Array","isArray","message","join","genericError","authApi","register","email","password","name","post","login","logout","listingsApi","popular","limit","get","search","query","params","URLSearchParams","append","String","toString","propertiesApi","getOne","id","projectsApi","landsApi","agentContactApi","payload","isAuthenticated","getErrorMessage","_error$response","_error$response$data","msg"],"sources":["/Users/norhanizawatizainol/Github Repo/developer-technical-assessment-starter-kit/Projects/frontend/src/api/client.ts"],"sourcesContent":["import axios, { AxiosInstance, AxiosError, InternalAxiosRequestConfig } from 'axios';\n\nconst API_BASE = process.env.REACT_APP_API_URL || 'http://localhost:3000';\n\nexport const api: AxiosInstance = axios.create({\n  baseURL: API_BASE,\n  headers: {\n    'Content-Type': 'application/json',\n  },\n  withCredentials: true, // Enable cookies in requests\n});\n\n// Custom error interface\nexport interface ApiError {\n  statusCode: number;\n  message: string | string[];\n  timestamp: string;\n  path: string;\n  method: string;\n}\n\n// Request interceptor - add auth token if stored\napi.interceptors.request.use(\n  (config: InternalAxiosRequestConfig) => {\n    // Token is automatically sent via HTTP-only cookie\n    // But we can also check localStorage for optional Bearer token backup\n    const token = localStorage.getItem('backup_jwt_token');\n    if (token) {\n      config.headers.Authorization = `Bearer ${token}`;\n    }\n    return config;\n  },\n  (error) => {\n    return Promise.reject(error);\n  },\n);\n\n// Response interceptor - handle errors globally\napi.interceptors.response.use(\n  (response) => response,\n  (error: AxiosError<ApiError>) => {\n    // Handle network errors\n    if (!error.response) {\n      const networkError = new Error('Network error. Please check your connection.');\n      (networkError as any).statusCode = 0;\n      return Promise.reject(networkError);\n    }\n\n    const { status, data } = error.response;\n\n    // Handle 401 - Token expired or invalid\n    if (status === 401) {\n      localStorage.removeItem('backup_jwt_token');\n      \n      if (window.location.pathname !== '/login') {\n        window.location.href = '/login?session_expired=true';\n      }\n\n      const authError = new Error('Session expired. Please log in again.');\n      (authError as any).statusCode = 401;\n      return Promise.reject(authError);\n    }\n\n    // Handle 403 - Forbidden\n    if (status === 403) {\n      const forbiddenError = new Error('You do not have permission to access this resource.');\n      (forbiddenError as any).statusCode = 403;\n      return Promise.reject(forbiddenError);\n    }\n\n    // Handle 404 - Not found\n    if (status === 404) {\n      const notFoundError = new Error('Resource not found.');\n      (notFoundError as any).statusCode = 404;\n      return Promise.reject(notFoundError);\n    }\n\n    // Handle 429 - Too many requests\n    if (status === 429) {\n      const rateLimitError = new Error('Too many requests. Please try again later.');\n      (rateLimitError as any).statusCode = 429;\n      return Promise.reject(rateLimitError);\n    }\n\n    // Handle 500+ - Server errors\n    if (status >= 500) {\n      const serverError = new Error('Server error. Please try again later.');\n      (serverError as any).statusCode = status;\n      return Promise.reject(serverError);\n    }\n\n    // Handle validation errors (400, 422)\n    if (status === 400 || status === 422) {\n      const validationError = new Error(\n        Array.isArray(data.message) ? data.message.join(', ') : data.message || 'Invalid request',\n      );\n      (validationError as any).statusCode = status;\n      return Promise.reject(validationError);\n    }\n\n    // Generic error handling\n    const message = Array.isArray(data.message) \n      ? data.message.join(', ') \n      : (data.message || `Error: ${status}`);\n    const genericError = new Error(message);\n    (genericError as any).statusCode = status;\n    return Promise.reject(genericError);\n  },\n);\n\n// Auth API\nexport const authApi = {\n  register: (email: string, password: string, name?: string) =>\n    api.post('/auth/register', { email, password, name }),\n  login: (email: string, password: string) =>\n    api.post('/auth/login', { email, password }),\n  logout: () => api.post('/auth/logout'),\n};\n\n// Listings API\nexport const listingsApi = {\n  popular: (limit: number = 6) => api.get(`/listings/popular?limit=${limit}`),\n  search: (query: string = '', location: string = '', limit: number = 20) => {\n    const params = new URLSearchParams();\n    if (query) params.append('q', query);\n    if (location) params.append('location', location);\n    params.append('limit', String(limit));\n    return api.get(`/listings/search?${params.toString()}`);\n  },\n};\n\n// Properties API\nexport const propertiesApi = {\n  getOne: (id: number | string) => api.get(`/property/${id}`),\n};\n\n// Projects API\nexport const projectsApi = {\n  getOne: (id: number | string) => api.get(`/project/${id}`),\n};\n\n// Lands API\nexport const landsApi = {\n  getOne: (id: number | string) => api.get(`/land/${id}`),\n};\n\n// Agent Contacts API\nexport const agentContactApi = {\n  create: (payload: { name: string; email: string; message: string; property_id?: number | null }) =>\n    api.post('/agent-contact', payload),\n};\n\n// Utility function to check if user is authenticated\nexport const isAuthenticated = (): boolean => {\n  return true; // Let backend validation via interceptors handle it\n};\n\n// Utility function to get error message from API error\nexport const getErrorMessage = (error: any): string => {\n  if (error?.message) {\n    return error.message;\n  }\n  if (error?.response?.data?.message) {\n    const msg = error.response.data.message;\n    return Array.isArray(msg) ? msg.join(', ') : msg;\n  }\n  return 'An unexpected error occurred. Please try again.';\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}